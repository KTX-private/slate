
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Madex API文档(v4)</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-4f67ce97.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-628c1a7f.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e033bdd3.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;,&quot;python&quot;,&quot;csharp&quot;]">
    <a href="#" id="nav-button">
      <span>
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <header>
      <div class="flex_box">
        <img src="images/logo-1e815a84.png" class="logo" id="bibox-logo" alt="" />
        <div class="nav_box">
          <span id="spot_select" class="nav-select">
            <span id="btn_spot-select">
              现货
            </span>

            <span class="nav-select-drop">
              <a href="/api/spot/v4/zh/" class="nav-select-item" id="btn_spot_v4">现货v4</a>
              <a href="/api/spot/v3/zh/" class="nav-select-item" id="btn_spot">现货v3</a>
            </span>
          </span>
          <span class="nav-select">
            <span id="btn_contract-select">
              U本位永续合约
            </span>

            <span class="nav-select-drop big">
              <a href="/api/futures/v4/zh/" class="nav-select-item" id="btn_contract_v4">U本位永续合约 v4</a>
              <a href="/api/futures/v3/zh/" class="nav-select-item" id="btn_contract_v3">U本位永续合约 v3</a>
            </span>
          </span>
          <span class="nav_cell nav_tab">
            <a href="/api/futures-coin/v3/zh/" id="btn_contract_coin">币本位永续合约</a>
          </span>
        </div>
      </div>
      <a href="/api/spot/v3/en/" class="lang" id="lang_box">English</a>
    </header>
    <div class="toc-wrapper">
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="csharp">csharp</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#b122f813d5" class="toc-h1 toc-link" data-title="基本信息">基本信息</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api" class="toc-h2 toc-link" data-title="API">API</a>
                  </li>
                  <li>
                    <a href="#a4d31b2542" class="toc-h2 toc-link" data-title="流量限制">流量限制</a>
                  </li>
                  <li>
                    <a href="#authentication" class="toc-h2 toc-link" data-title="Authentication">Authentication</a>
                  </li>
                  <li>
                    <a href="#api-key" class="toc-h2 toc-link" data-title="Api Key权限">Api Key权限</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#market-data-endpoints" class="toc-h1 toc-link" data-title="Market Data Endpoints">Market Data Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-listed-pairs" class="toc-h2 toc-link" data-title="Get Listed Pairs">Get Listed Pairs</a>
                  </li>
                  <li>
                    <a href="#get-order-book" class="toc-h2 toc-link" data-title="Get Order Book">Get Order Book</a>
                  </li>
                  <li>
                    <a href="#get-candles" class="toc-h2 toc-link" data-title="Get Candles">Get Candles</a>
                  </li>
                  <li>
                    <a href="#get-trades" class="toc-h2 toc-link" data-title="Get Trades">Get Trades</a>
                  </li>
                  <li>
                    <a href="#get-tickers" class="toc-h2 toc-link" data-title="Get Tickers">Get Tickers</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#market-data-streams" class="toc-h1 toc-link" data-title="Market Data Streams">Market Data Streams</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#request-methods" class="toc-h2 toc-link" data-title="Request Methods">Request Methods</a>
                  </li>
                  <li>
                    <a href="#subscribe-order-book" class="toc-h2 toc-link" data-title="Subscribe Order Book">Subscribe Order Book</a>
                  </li>
                  <li>
                    <a href="#subscribe-trades" class="toc-h2 toc-link" data-title="Subscribe Trades">Subscribe Trades</a>
                  </li>
                  <li>
                    <a href="#subscribe-candles" class="toc-h2 toc-link" data-title="Subscribe Candles">Subscribe Candles</a>
                  </li>
                  <li>
                    <a href="#subscribe-tickers" class="toc-h2 toc-link" data-title="Subscribe Tickers">Subscribe Tickers</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#user-data-endpoints" class="toc-h1 toc-link" data-title="User Data Endpoints">User Data Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-accounts" class="toc-h2 toc-link" data-title="Get Accounts">Get Accounts</a>
                  </li>
                  <li>
                    <a href="#get-an-account-39-s-ledger" class="toc-h2 toc-link" data-title="Get an account's ledger">Get an account's ledger</a>
                  </li>
                  <li>
                    <a href="#create-an-order" class="toc-h2 toc-link" data-title="Create an order">Create an order</a>
                  </li>
                  <li>
                    <a href="#get-an-order" class="toc-h2 toc-link" data-title="Get an order">Get an order</a>
                  </li>
                  <li>
                    <a href="#get-orders" class="toc-h2 toc-link" data-title="Get Orders">Get Orders</a>
                  </li>
                  <li>
                    <a href="#cancel-an-order" class="toc-h2 toc-link" data-title="Cancel an Order">Cancel an Order</a>
                  </li>
                  <li>
                    <a href="#cancel-all-orders" class="toc-h2 toc-link" data-title="Cancel all Orders">Cancel all Orders</a>
                  </li>
                  <li>
                    <a href="#get-fills" class="toc-h2 toc-link" data-title="Get fills">Get fills</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#user-data-streams" class="toc-h1 toc-link" data-title="User Data Streams">User Data Streams</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview-2" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#account" class="toc-h2 toc-link" data-title="Account">Account</a>
                  </li>
                  <li>
                    <a href="#position" class="toc-h2 toc-link" data-title="Position">Position</a>
                  </li>
                  <li>
                    <a href="#order" class="toc-h2 toc-link" data-title="Order">Order</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#e08c1d4f9a" class="toc-h2 toc-link" data-title="错误码">错误码</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://www.madex.com'>开始交易</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='b122f813d5'>基本信息</h1><h2 id='api'>API</h2>
<p><strong>使用API开发应用程序，您可以准确地获取Madex现货市场的行情数据，快速进行自动化交易。API包含众多接口，按功能大致分为以下几组：</strong></p>

<ul>
<li>Market Data Endpoints 用于获取行情数据的REST接口</li>
<li>User Data Endpoints 用于获取用户私有数据的REST接口</li>
<li>Market Data Streams 用于获取行情数据的WebSocket接口</li>
<li>User Data Streams 用于获取用户私有数据的WebSocket接口</li>
</ul>

<p><strong>API使用如下Base URL：</strong></p>

<ul>
<li>Market Data Endpoints: https://ma-tapi.tonetou.com/api</li>
<li>User Data Endpoints: https://api-user.tonetou.com/api</li>
<li>Market Data Stream: wss://stream-market.tonetou.com</li>
<li>User Data Stream: wss://madex-user.tonetou.com</li>
</ul>

<p><strong>备用api域名列表</strong></p>

<p><a href="https://api.madex.tel/v1/public/queryApiDomain">https://api.madex.tel/v1/public/queryApiDomain</a></p>

<p><strong>API的REST接口使用以下HTTP方法：</strong></p>

<ul>
<li>GET 用于获取行情或私有数据</li>
<li>POST 用于提交委托等操作</li>
</ul>

<p><strong>API的REST接口所需的参数应根据以下规则附加于请求中：</strong></p>

<ul>
<li>GET类型的接口参数应附加于Query String中</li>
<li>POST类型的接口参数应以JSON格式附加于Request Body中</li>
</ul>

<p><strong>Response</strong></p>

<p>API的响应数据都以JSON格式返回，具体格式请参考各接口的描述。</p>

<p><strong>Error</strong></p>

<p>API的错误以如下JSON格式返回：</p>

<p>{<br/>
&nbsp;&nbsp;&quot;state&quot;: error code,<br/>
&nbsp;&nbsp;&quot;msg&quot;: &quot;error message&quot;<br/>
}</p>

<p><em>其中，state表示错误的类型，msg包含错误产生的原因或如何避免错误的提示。具体的错误类型请参考<a href="#errors">Error</a>章节的内容。</em></p>

<p><strong>Time or Timestamp</strong></p>

<p>API接口参数和响应数据中所涉及的时间值都是UNIX时间，单位为毫秒。</p>

<hr>
<h2 id='a4d31b2542'>流量限制</h2>
<p><strong>Madex对来自于同一IP的请求做以下访问限制:</strong></p>

<ol>
<li>Access Limits 访问频率限制</li>
<li>Usage Limits CPU用量限制</li>
</ol>

<ul>
<li>Access Limits访问频率限制

<ol>
<li>同一IP每10秒最多10000次请求，超出限制的请求会收到-20007错误。</li>
<li>用户可以根据需要在10秒内以任意频率发送最多10000次请求，可以大约每10ms发送一次，也可以在1秒内连续发送10000次，然后等待9秒。
<br/>
<br/></li>
</ol></li>
<li>Usage Limits用量限制

<ol>
<li>同一IP每10秒最多消耗10000点CPU 时间，超出限制的请求会收到-20006错误。</li>
<li>不同API消耗的CPU时间不同，这取决于API如何访问数据。</li>
<li>在本文中, 每个API接口访问数据的方式会以“缓存”, “数据库”的形式标明。访问缓存的API消耗的CPU时间较少，访问数据库的API消耗的CPU时间较多。根据用户发送的参数，API可能混合访问缓存和数据库，甚至多次访问数据库，这会增加API消耗的CPU时间。</li>
<li>每次API请求消耗的CPU时间会包含在响应头Madex-Usage中，其格式为t1:t2:t3，其中，t1表示本次API请求消耗的CPU时间，t2表示最近10秒内当前IP消耗的CPU时间，t3表示最近10秒内当前IP剩余的可用CPU时间。</li>
</ol></li>
</ul>

<hr>
<h2 id='authentication'>Authentication</h2>
<blockquote>
<p>完整例子</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=BTC</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span> <span class="c1">// POST or DELETE  replace queryStr with bodyStr</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/accounts?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span> <span class="c1">// optional</span>
          <span class="p">},</span>
        <span class="p">},</span>

        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/accounts'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=BTC'</span>
    <span class="c1"># POST or DELETE replace query_str with body_str
</span>    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">query_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<p><strong>身份验证</strong></p>

<ul>
<li>私有接口用于访问账户、委托等私有信息，在请求时需要附加签名，以满足Madex进行身份验证。本节将描述如何创建签名。</li>
</ul>

<p><strong>生成Api Key</strong></p>

<ul>
<li>要创建签名，首先需要生成Api Key和Secret Key组合。请牢记在此过程中生成的Secret Key，因为该值仅显示一次，如果忘记了Secret Key，请删除该Api Key，并生成新的Api Key和Secret Key组合。</li>
</ul>

<p><strong>HTTP 请求头</strong></p>

<p><strong>访问私有接口的请求都必需附加以下HTTP请求头：</strong></p>

<ul>
<li>api-key 已生成的Api Key</li>
<li>api-sign 签名</li>
</ul>

<p><strong>如果需要，也可以附加以下HTTP请求头：</strong></p>

<ul>
<li>api-expire-time

<ol>
<li>接口过期时间。</li>
<li>该值是以毫秒为单位的Unix时间，服务器会忽略该时间之后收到的请求，这主要用于避免网络延迟带来的影响。</li>
</ol></li>
</ul>

<p><strong>创建签名</strong></p>

<p>在发送请求前，首先确定用于签名的消息体。对于GET类型的请求，Query String是需要签名的消息体，对于POST请求，Body String是需要签名的消息体。签名的具体方法如下：</p>

<ul>
<li>第一步：以Secret Key作为Key对需要签名的消息体执行HmacSHA256算法</li>
<li>第二步：将以上结果转化为Hex String</li>
<li>第三步：将Hex String作为请求头api-sign的值</li>
</ul>
<h2 id='api-key'>Api Key权限</h2>
<p><strong>私有接口需要特定的权限才能执行。可以为Api Key授予适当的权限。如果Api Key未被授予某个接口需要的权限，那么使用该Api Key提交的请求将被拒绝。</strong></p>

<p><strong>可以授予Api Key以下权限：</strong></p>

<ul>
<li>View权限允许Api Key获取私有数据。</li>
<li>Trade权限允许Api Key提交或撤销委托，并允许Api Key获取交易相关的数据。</li>
</ul>

<p><em>接口需要的权限将在每个接口的描述中给出。</em></p>

<hr>
<h1 id='market-data-endpoints'>Market Data Endpoints</h1><h2 id='get-listed-pairs'>Get Listed Pairs</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://ma-tapi.tonetou.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/products?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://ma-tapi.tonetou.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/products?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"market"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lpc"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">spot</span><span class="w"> </span><span class="err">or</span><span class="w"> </span><span class="err">lpc</span><span class="w"> </span><span class="err">现货或者合约</span><span class="w">
    </span><span class="nl">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对</span><span class="w">
    </span><span class="nl">"takerFee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">taker手续费</span><span class="w">
    </span><span class="nl">"makerFee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="nl">"minOrderSize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最小下单数量</span><span class="w">
    </span><span class="nl">"maxOrderSize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">最大下单数量</span><span class="w">
    </span><span class="nl">"quantityScale"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数量精度</span><span class="w">
    </span><span class="nl">"priceScale"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">价格精度</span><span class="w">
    </span><span class="nl">"minOrderValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最小下单价值</span><span class="w">
    </span><span class="nl">"maxOrderValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10000000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最大下单价值</span><span class="w">
    </span><span class="nl">"fundingRate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0001"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资金费率</span><span class="w">
    </span><span class="nl">"nextFundingTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733472000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">资金费率结算时间</span><span class="w">
    </span><span class="nl">"predictedFundingRate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0001"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">预期资金费率</span><span class="w">
    </span><span class="nl">"markPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98042.3405"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">标记价格</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取币种列表</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/products</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>交易对代码，如 BTC_USDT, ETH_USDT 等，不指定返回全部交易对</td>
</tr>
</tbody></table>

<ul>
<li>Data source</li>
</ul>

<p>Cache</p>
<h2 id='get-order-book'>Get Order Book</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://ma-tapi.tonetou.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/order_book?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://ma-tapi.tonetou.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order_book?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1027024"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">id</span><span class="w">
  </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1644558642100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">update</span><span class="w"> </span><span class="err">time</span><span class="w">
  </span><span class="nl">"b"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">买盘</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"a"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖盘</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
      </span><span class="s2">"0.079045"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托量</span><span class="w">
    </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>获取深度数据</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/order_book</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码，如 BTC_USDT, ETH_USDT 等</td>
</tr>
<tr>
<td>level</td>
<td>int32</td>
<td>否</td>
<td>指定最多返回多少级深度<br/>有效值 1, 2, 5, 10, 20, 50, 100, 200, 500, 1000<br/>默认值 100</td>
</tr>
<tr>
<td>price_scale</td>
<td>integer</td>
<td>否</td>
<td>指定按价格合并深度，如指定交易对的价格最多含4位小数<br/>price_scale=0 时返回的价格最多含4位小数,<br/>price_scale=1 时返回的价格最多含3位小数, 委托量是价格区间0.0010中全部委托量的和<br/>price_scale=2 时返回的价格最多含2位小数, 委托量是价格区间0.0100中全部委托量的和<br/>price_scale=3 时返回的价格最多含1位小数, 委托量是价格区间0.1000中全部委托量的和<br/>price_scale=4 时返回的价格最多含0位小数, 委托量是价格区间1.0000中全部委托量的和<br/>有效值 0, 1, 2, 3, 4, 5<br/>默认值 0</td>
</tr>
</tbody></table>

<blockquote>
<p>注意: 数据按价格最优排序, 即买侧深度按价格由大到小排序, 卖侧深度按价格由小到大排序</p>
</blockquote>

<ul>
<li>Data source</li>
</ul>

<p>Cache</p>
<h2 id='get-candles'>Get Candles</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://ma-tapi.tonetou.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/candles?market=spot&amp;symbol=BTC_USDT&amp;time_frame=1m`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://ma-tapi.tonetou.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/candles?market=spot&amp;symbol=BTC_USDT&amp;time_frame=1m'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="mi">60000</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间周期</span><span class="w">
  </span><span class="nl">"e"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"1644224940000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">起始时间</span><span class="w">
      </span><span class="s2">"10190.53"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
      </span><span class="s2">"10192.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最高价格</span><span class="w">
      </span><span class="s2">"9806.82"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最低价格</span><span class="w">
      </span><span class="s2">"10127.37"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">收盘价格</span><span class="w">
      </span><span class="s2">"0.834"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
      </span><span class="s2">"8370.40506"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价值</span><span class="w">
      </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">首个成交的id</span><span class="w">
      </span><span class="mi">278</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">区间内总成交次数</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="s2">"1644224940000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"10190.53"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"10192.5"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"9806.82"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"10127.37"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"0.834"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"8370.40506"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
      </span><span class="mi">278</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>获取K线数据</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/candles</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码，如 BTC_USDT, ETH_USDT 等</td>
</tr>
<tr>
<td>time_frame</td>
<td>string</td>
<td>是</td>
<td>K线数据的时间周期<br/>有效值 1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 3d, 1W或1M</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>utc时间<br/>限定返回K线记录的最近时间</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>utc时间<br/>限定返回K线记录的最早时间</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>否</td>
<td>获取K线记录的最大数量<br/>默认值100，最大值1000</td>
</tr>
</tbody></table>

<ul>
<li>该接口支持的参数组合和数据源</li>
</ul>

<ol>
<li>symbol + time_frame  --&gt; cache</li>
<li>symbol + time_frame + limit  --&gt; cache</li>
<li>symbol + time_frame + before  --&gt; database</li>
<li>symbol + time_frame + before + limit  --&gt; database</li>
<li>symbol + time_frame + after  --&gt; database</li>
<li>symbol + time_frame + after + limit  --&gt; database</li>
</ol>

<blockquote>
<p>返回结果按时间由早及近排序</p>
</blockquote>
<h2 id='get-trades'>Get Trades</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://ma-tapi.tonetou.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/trades?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://ma-tapi.tonetou.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/trades?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="s2">"17122255"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
    </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w"> </span><span class="mi">1</span><span class="err">代表买</span><span class="w"> </span><span class="mi">-1</span><span class="err">代表卖</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="s2">"17122255"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
    </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w"> </span><span class="mi">1</span><span class="err">代表买</span><span class="w"> </span><span class="mi">-1</span><span class="err">代表卖</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"i"</span><span class="p">:</span><span class="w"> </span><span class="s2">"17122255"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"p"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46125.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"q"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.079045"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交量</span><span class="w">
    </span><span class="nl">"s"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Taker</span><span class="w"> </span><span class="err">的成交方向</span><span class="w"> </span><span class="mi">1</span><span class="err">代表买</span><span class="w"> </span><span class="mi">-1</span><span class="err">代表卖</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1628738748319"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取交易记录</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/trades</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码，如 BTC_USDT, ETH_USDT 等</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回交易记录的最早时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回交易记录的最近时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>交易记录 id<br/>限定返回交易记录的最大id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>交易记录 id<br/>限定返回交易记录的最大id</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>否</td>
<td>获取记录的最大数量<br/>默认值100，最大值1000</td>
</tr>
</tbody></table>

<ul>
<li>该接口支持的参数组合和数据源</li>
</ul>

<ol>
<li>symbol  --&gt; cache</li>
<li>symbol + limit  --&gt; cache</li>
<li>symbol + start_time  --&gt; database</li>
<li>symbol + start_time + limit  --&gt; database</li>
<li>symbol + end_time  --&gt; database</li>
<li>symbol + end_time + limit  --&gt; database</li>
<li>symbol + start_time + end_time  --&gt; database</li>
<li>symbol + start_time + end_time + limit  --&gt; database</li>
<li>symbol + before  --&gt; database</li>
<li>symbol + before + limit  --&gt; database</li>
<li>symbol + after  --&gt; database</li>
<li>symbol + after + limit  --&gt; database</li>
</ol>

<p><em>数据源为cache的参数组合用于获取最近1000条交易记录</em></p>

<p><em>数据源为database的参数组合用于获取较早的交易记录</em></p>

<p><em>如果用数据源为database的参数组合获取最新交易记录，其结果要比cache数据源稍有延迟</em>
* Usage
  <strong>用法举例：获取三个月内某交易对的全部交易记录</strong></p>

<ol>
<li>首先使用symbol + limit 参数组合获取最新的交易记录</li>
<li>将取到的首条记录的tradeId作为before参数的值，反复使用symbol + before + limit参数组合获取更多记录，直至获取三个月内的全部交易记录后停止</li>
</ol>

<blockquote>
<p>返回结果按交易记录id由小到大排序</p>
</blockquote>
<h2 id='get-tickers'>Get Tickers</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">endPoint</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://ma-tapi.tonetou.com/api</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endPoint</span><span class="p">}</span><span class="s2">/v1/ticker?market=spot&amp;symbol=BTC_USDT`</span>
<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span>
        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://ma-tapi.tonetou.com/api'</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/ticker?market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"askPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一价</span><span class="w">
    </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"922635"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">成交价值</span><span class="w">
    </span><span class="nl">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">最新成交价</span><span class="w">
    </span><span class="nl">"firstTradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">第一笔交易id</span><span class="w">
    </span><span class="nl">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">价格变化</span><span class="w">
    </span><span class="nl">"bidQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.7"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一数量</span><span class="w">
    </span><span class="nl">"bidPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">买一价</span><span class="w">
    </span><span class="nl">"volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.41"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h成交数量</span><span class="w">
    </span><span class="nl">"lastQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h最新成交</span><span class="w">
    </span><span class="nl">"askQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">卖一数量</span><span class="w">
    </span><span class="nl">"high"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98100"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">最高价</span><span class="w">
    </span><span class="nl">"tradeCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
    </span><span class="nl">"low"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="mi">24</span><span class="err">h最低价</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733474204000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间</span><span class="w">
    </span><span class="nl">"open"</span><span class="p">:</span><span class="w"> </span><span class="s2">"98000"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">开盘价格</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取报价数据</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/ticker</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码，如 BTC_USDT, ETH_USDT 等，<br/>可按如下两种形式指定多个交易对代码<br/> 1. /pairs?symbol=BTC_USDT,ETH_USDT<br/> 2. /pairs?symbol=BTC_USDT&amp;symbol=ETH_USDT</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>Cache</p>
<h1 id='market-data-streams'>Market Data Streams</h1><h2 id='overview'>Overview</h2>
<blockquote>
<p>例子</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">madexws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://stream-market.tonetou.com</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">madexws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">madexws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:[</span><span class="dl">"</span><span class="s2">spot.BTC_USDT.order_book.5</span><span class="dl">"</span><span class="p">]}));</span>
        <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">ws</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
        <span class="p">},</span><span class="mi">30000</span><span class="p">)</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">rece message</span><span class="dl">"</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">websocket</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://stream-market.tonetou.com'</span>

<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span><span class="s">"method"</span><span class="p">:</span><span class="s">"SUBSCRIBE"</span><span class="p">,</span><span class="s">"params"</span><span class="p">:[</span><span class="s">"spot.BTC_USDT.order_book.5"</span><span class="p">]}</span> 
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="c1"># websocket.enableTrace(True)
</span>    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div>
<p><strong>使用 Websocket 推送服务可以及时获取行情信息。</strong></p>

<ul>
<li>连接 Websocket 服务器
请使用以下 URL 连接 Websocket 服务器：
<br/>
wss://stream-market.tonetou.com</li>
</ul>

<blockquote>
<p>在连接后，客户端可以发送以下JSON格式的请求给服务器</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">由客户端给定的请求id</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">请求类型</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:[</span><span class="s2">"spot.BTC_USDT.order_book.5"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>在收到请求后，服务器会发送以下JSON格式的响应给客户端</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">返回结果</span><span class="w">
  </span><span class="nl">"op"</span><span class="p">:</span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">由客户端给定的请求id</span><span class="w">
  </span><span class="nl">"events"</span><span class="p">:[</span><span class="s2">"spot.BTC_USDT.order_book.5"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>如果发生错误，服务器会发送以下错误信息给客户端</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">请求id</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1003</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">错误代码</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">错误描述</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>同时，服务器还会发送以下JSON格式的数据流给客户端, 数据流包含市场行情的变化信息</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spot.BTC_USDT.order_book.5"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数据流名称</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数据</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>请求：订阅数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUBSCRIBE"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"stream name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"stream name"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>在连接后，请首先发送该请求给服务器，随后，服务器会在行情变化时发送相应的数据流给客户端。</p>

<p>&quot;data stream name&quot; 是数据流名称，数据流名称是以下格式的字符串。
market.symbol.data_type.param1.param2...</p>

<p>其中，market是交易对市场，如spot和lpc
symbol是交易对名称，如 BTC_USDT、ETH_USDT 等。
data_type是数据类型，目前仅支持以下数据类型
order_book: 深度
trades: 交易列表
candles: K线
ticker: 最新成交信息</p>

<p>在data_type之后是参数列表，不同的数据类型有不同的参数列表，这些将在后续介绍</p>

<p>请求: 取消订阅数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">UNSUBSCRIBE</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">"</span><span class="s2">data stream name</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">data stream name</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>如果请求被服务器正确处理，客户端会收到以下响应:</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">result</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">success</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 返回结果</span>
    <span class="dl">"</span><span class="s2">op</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...</span> 
    <span class="p">}</span>
</code></pre></div>
<blockquote>
<p>如果请求出错，客户端会收到以下错误响应:</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">:</span> <span class="o">-</span><span class="mi">1003</span><span class="p">,</span> <span class="c1">// 错误代码</span>
  <span class="dl">"</span><span class="s2">message</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">...</span><span class="dl">"</span> <span class="c1">// 错误描述</span>
<span class="p">}</span>
</code></pre></div><h2 id='request-methods'>Request Methods</h2>
<blockquote>
<p>请求类型及参数</p>

<p>客户端可以发送以下请求给服务器</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="c1">// 由客户端给定的请求id</span>
  <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">...</span><span class="dl">"</span> <span class="c1">// 请求类型</span>
  <span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// 请求参数列表</span>
    <span class="dl">"</span><span class="s2">...</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">...</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>其中method字段的值是以下请求类型之一:</li>
</ul>

<table><thead>
<tr>
<th>可选值</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>SUBSCRIBE</td>
<td>1.订阅数据流<br/> 2.参数是数据流名称列表 <br/> 3.在成功订阅后，服务器会在行情发生变化时发送数据流给客户端</td>
</tr>
<tr>
<td>UNSUBSCRIBE</td>
<td>1.取消订阅数据流<br/> 2.参数是数据流名称列表 <br/> 3.在成功取消订阅后，客户端不会再收到相应的数据流</td>
</tr>
</tbody></table>
<h2 id='subscribe-order-book'>Subscribe Order Book</h2>
<p><strong>订阅深度信息</strong></p>

<blockquote>
<p>发送以下请求可订阅深度信息</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">"</span><span class="s2">spot.BTC_USDT.order_book.20</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">spot.ETH_USDT.order_book.20</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>该请求的参数是深度流名称，格式如下：</li>
</ol>

<ul>
<li>&lt;market&gt;<symbol>.order_book.&lt;max depth&gt;

<ol>
<li>&lt;market&gt; 是交易对市场，如spot，lpc</li>
<li>&lt;symbol&gt; 是交易对名称，如BTC_USDT，ETH_USDT等</li>
<li>&lt;max depth&gt; 是最大深度，有效值是5, 10, 20, 50, 100, 200, 500, 1000</li>
</ol></li>
</ul>

<blockquote>
<p>数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">spot.BTC_USDT.order_book.20</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">i</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1027024</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// update id</span>
      <span class="dl">"</span><span class="s2">t</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1644558642100</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// update time</span>
      <span class="dl">"</span><span class="s2">b</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// 买盘</span>
        <span class="p">[</span>
            <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托价格</span>
            <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span> <span class="c1">// 委托量</span>
          <span class="p">],</span>
        <span class="p">[</span>
            <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托价格</span>
            <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span> <span class="c1">// 委托量</span>
          <span class="p">],</span>
        <span class="p">[</span>
            <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托价格</span>
            <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span> <span class="c1">// 委托量</span>
          <span class="p">],</span>
        <span class="p">...</span>
      <span class="p">],</span>
      <span class="dl">"</span><span class="s2">a</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// 卖盘</span>
        <span class="p">[</span>
            <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托价格</span>
            <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span> <span class="c1">// 委托量</span>
          <span class="p">],</span>
        <span class="p">[</span>
            <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托价格</span>
            <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span> <span class="c1">// 委托量</span>
          <span class="p">],</span>
        <span class="p">[</span>
            <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托价格</span>
            <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span> <span class="c1">// 委托量</span>
          <span class="p">],</span>
       <span class="p">...</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>
<blockquote>
<p>在成功订阅后，客户端会首先收到一个完整深度的数据流，之后会收到增量变化数据流，请按以下方法合成完整的深度，或使用SDK.</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>  <span class="p">...</span>
</code></pre></div><h2 id='subscribe-trades'>Subscribe Trades</h2>
<p><strong>订阅交易列表</strong></p>

<blockquote>
<p>发送以下请求可订阅交易列表</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span>
  <span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">"</span><span class="s2">spot.BTC_USDT.trades</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">spot.ETH_USDT.trades</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>该请求的参数是交易流名称，格式如下：</li>
</ol>

<ul>
<li>&lt;symbol&gt;.trades

<ol>
<li>&lt;market&gt; 是交易对市场，如spot，lpc</li>
<li>&lt;symbol&gt; 是交易对名称，如BTC_USDT，ETH_USDT等</li>
</ol></li>
</ul>

<blockquote>
<p>数据流</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">spot.BTC_USDT.trades</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">i</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">17122255</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易 id</span>
      <span class="dl">"</span><span class="s2">p</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交价格</span>
      <span class="dl">"</span><span class="s2">q</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交量</span>
      <span class="dl">"</span><span class="s2">s</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">buy</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Taker 的成交方向</span>
      <span class="dl">"</span><span class="s2">t</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1628738748319</span><span class="dl">"</span> <span class="c1">// 成交时间</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">i</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">17122255</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易 id</span>
      <span class="dl">"</span><span class="s2">p</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交价格</span>
      <span class="dl">"</span><span class="s2">q</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交量</span>
      <span class="dl">"</span><span class="s2">s</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">buy</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Taker 的成交方向</span>
      <span class="dl">"</span><span class="s2">t</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1628738748319</span><span class="dl">"</span> <span class="c1">// 成交时间</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">i</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">17122255</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易 id</span>
      <span class="dl">"</span><span class="s2">p</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">46125.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交价格</span>
      <span class="dl">"</span><span class="s2">q</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.079045</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交量</span>
      <span class="dl">"</span><span class="s2">s</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">buy</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Taker 的成交方向</span>
      <span class="dl">"</span><span class="s2">t</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1628738748319</span><span class="dl">"</span> <span class="c1">// 成交时间</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div><h2 id='subscribe-candles'>Subscribe Candles</h2>
<p><strong>订阅K线</strong></p>

<blockquote>
<p>发送以下请求可订阅K线</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span>
  <span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">"</span><span class="s2">spot.BTC_USDT.candles.1m</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">spot.ETH_USDT.candles.1h</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>K线流名称格式如下：</li>
</ol>

<ul>
<li>&lt;symbol&gt;.candles.&lt;time_frame&gt;

<ol>
<li>&lt;market&gt; 是交易对市场，如spot，lpc</li>
<li>&lt;symbol&gt; 是交易对名称，如BTC_USDT，ETH_USDT等</li>
<li>&lt;time_frame&gt; 是K线周期，有效值是1m, 3m, 5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d, 1w, 1M
&gt; 数据流</li>
</ol></li>
</ul>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">spot.BTC_USDT.candles.1m</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">t</span><span class="dl">"</span><span class="p">:</span><span class="mi">60000</span><span class="p">,</span> <span class="c1">// 时间周期</span>
      <span class="dl">"</span><span class="s2">e</span><span class="dl">"</span><span class="p">:[</span>
      <span class="p">[</span>
        <span class="dl">"</span><span class="s2">1644224940000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 起始时间</span>
        <span class="dl">"</span><span class="s2">10190.53</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 开盘价格</span>
        <span class="dl">"</span><span class="s2">10192.5</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 最高价格</span>
        <span class="dl">"</span><span class="s2">9806.82</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 最低价格</span>
        <span class="dl">"</span><span class="s2">10127.37</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 收盘价格</span>
        <span class="dl">"</span><span class="s2">0.834</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交量</span>
        <span class="dl">"</span><span class="s2">8370.40506</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交价值</span>
        <span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 首个成交的id</span>
        <span class="mi">278</span> <span class="c1">// 区间内总成交次数</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="dl">"</span><span class="s2">1644224940000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 起始时间</span>
        <span class="dl">"</span><span class="s2">10190.53</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 开盘价格</span>
        <span class="dl">"</span><span class="s2">10192.5</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 最高价格</span>
        <span class="dl">"</span><span class="s2">9806.82</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 最低价格</span>
        <span class="dl">"</span><span class="s2">10127.37</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 收盘价格</span>
        <span class="dl">"</span><span class="s2">0.834</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交量</span>
        <span class="dl">"</span><span class="s2">8370.40506</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交价值</span>
        <span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 首个成交的id</span>
        <span class="mi">278</span> <span class="c1">// 区间内总成交次数</span>
      <span class="p">],</span>
      <span class="p">[</span>
        <span class="dl">"</span><span class="s2">1644224940000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 起始时间</span>
        <span class="dl">"</span><span class="s2">10190.53</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 开盘价格</span>
        <span class="dl">"</span><span class="s2">10192.5</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 最高价格</span>
        <span class="dl">"</span><span class="s2">9806.82</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 最低价格</span>
        <span class="dl">"</span><span class="s2">10127.37</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 收盘价格</span>
        <span class="dl">"</span><span class="s2">0.834</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交量</span>
        <span class="dl">"</span><span class="s2">8370.40506</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 成交价值</span>
        <span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 首个成交的id</span>
        <span class="mi">278</span> <span class="c1">// 区间内总成交次数</span>
      <span class="p">],</span>
      <span class="p">...</span>
    <span class="p">]}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id='subscribe-tickers'>Subscribe Tickers</h2>
<p><strong>订阅K线</strong></p>

<blockquote>
<p>发送以下请求可订阅Ticker</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SUBSCRIBE</span><span class="dl">"</span>
  <span class="dl">"</span><span class="s2">params</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">"</span><span class="s2">spot.BTC_USDT.ticker</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">spot.ETH_USDT.ticker</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>参数</li>
</ul>

<ol>
<li>Ticker流名称格式如下：</li>
</ol>

<ul>
<li>&lt;symbol&gt;.ticker

<ol>
<li>&lt;market&gt; 是交易对市场，如spot，lpc</li>
<li>&lt;symbol&gt; 是交易对名称，如BTC_USDT，ETH_USDT等
&gt; 数据流</li>
</ol></li>
</ul>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">spot.BTC_USDT.ticker</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>   
    <span class="dl">"</span><span class="s2">askPrice</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">98100</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 卖一价</span>
    <span class="dl">"</span><span class="s2">product</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">BTC_USDT</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易对</span>
    <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">922635</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 24成交价值</span>
    <span class="dl">"</span><span class="s2">last</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">98000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 最新成交价</span>
    <span class="dl">"</span><span class="s2">firstTradeId</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// 第一笔交易id</span>
    <span class="dl">"</span><span class="s2">change</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 价格变化</span>
    <span class="dl">"</span><span class="s2">bidQty</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1.7</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 卖一数量</span>
    <span class="dl">"</span><span class="s2">bidPrice</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">98000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 买一价</span>
    <span class="dl">"</span><span class="s2">volume</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">9.41</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 24h成交数量</span>
    <span class="dl">"</span><span class="s2">lastQty</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.3</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 24h最新成交</span>
    <span class="dl">"</span><span class="s2">askQty</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.5</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 卖一数量</span>
    <span class="dl">"</span><span class="s2">high</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">98100</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 24最高价</span>
    <span class="dl">"</span><span class="s2">tradeCount</span><span class="dl">"</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="c1">// 成交次数</span>
    <span class="dl">"</span><span class="s2">low</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">98000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 24h最低价</span>
    <span class="dl">"</span><span class="s2">time</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1733474204000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 时间</span>
    <span class="dl">"</span><span class="s2">open</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">98000</span><span class="dl">"</span> <span class="c1">// 开盘价格</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr>
<h1 id='user-data-endpoints'>User Data Endpoints</h1><h2 id='get-accounts'>Get Accounts</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=BTC</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/accounts?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span> <span class="c1">// optional</span>
          <span class="p">},</span>
        <span class="p">},</span>

        <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

        <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/accounts'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=BTC'</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">query_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="mi">10000</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">总额</span><span class="w">
    </span><span class="nl">"holds"</span><span class="p">:</span><span class="mi">0</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">冻结额</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="mi">10000</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">总额</span><span class="w">
    </span><span class="nl">"holds"</span><span class="p">:</span><span class="mi">0</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">冻结额</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取 API Key 对应账户中各种资产的余额, 冻结等信息</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/accounts</li>
<li>权限: View, Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>asset</td>
<td>string</td>
<td>否</td>
<td>资产代码，如 BTC, ETH 等<br/>可按以下两种形式指定多个资产代码<br/>1. /v1/accounts?asset=BTC,ETH<br/> 2. /v1/accounts?asset=BTC&amp;asset=ETH <br/> 如果不指定 asset 参数, 则返回全部资产的信息</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>Cache</p>
<h2 id='get-an-account-39-s-ledger'>Get an account&#39;s ledger</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">asset=BTC&amp;end_time=1651895799668&amp;limit=10</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/ledger?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span> <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/ledger'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'asset=BTC&amp;end_time=1651895799668&amp;limit=10'</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">query_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="s2">"10000"</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">变化数量</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="s2">"10000"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">余额</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842624029"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="s2">"1733468814795"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">时间</span><span class="w">
    </span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"transfer"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">账单类型</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取 API Key 对应账户的账单，包含一切改变账户余额的记录，如资金划转、交易、手续费收取等</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/ledger</li>
<li>权限: View, Trade</li>
<li>请求参数(需要排序)</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>asset</td>
<td>string</td>
<td>否</td>
<td>资产代码，如 BTC, ETH 等<br/>可按以下两种形式指定多个资产代码<br/>1. /v1/ledger?asset=BTC,ETH<br/> 2. /v1/ledger?asset=BTC&amp;asset=ETH <br/> 如果不指定 asset 参数, 则返回全部资产的账单记录</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回账单记录的最早时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回账单记录的最近时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>账单记录id<br/>限定返回账单记录的最大id值</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>账单记录id<br/>限定返回账单记录的最小id值</td>
</tr>
<tr>
<td>limit</td>
<td>int32</td>
<td>否</td>
<td>限定返回账单记录的最大条数<br/>默认值 100</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>否</td>
<td>账单类型 transfer划转，trade交易，fee手续费，rebate系统收取，funding资金费用</td>
</tr>
</tbody></table>

<ul>
<li>Data Source</li>
</ul>

<p>DB</p>
<h2 id='create-an-order'>Create an order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">BTC_USDT</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">quantity</span><span class="p">:</span><span class="dl">'</span><span class="s1">0.0001</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">price</span><span class="p">:</span><span class="dl">'</span><span class="s1">90000</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span><span class="dl">'</span><span class="s1">limit</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">market</span><span class="p">:</span><span class="dl">'</span><span class="s1">spot</span><span class="dl">'</span><span class="p">,</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/order`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'symbol'</span><span class="p">:</span><span class="s">'BTC_USDT'</span><span class="p">,</span>
      <span class="s">'quantity'</span><span class="p">:</span><span class="s">'0.0001'</span><span class="p">,</span>
      <span class="s">'price'</span><span class="p">:</span><span class="s">'90000'</span><span class="p">,</span>
      <span class="s">'type'</span><span class="p">:</span><span class="s">'limit'</span><span class="p">,</span>
      <span class="s">'market'</span><span class="p">:</span><span class="s">'spot'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">body_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span><span class="mi">5000</span><span class="p">))</span> <span class="c1"># optional
</span>    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"orderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4611767382287843330"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
  </span><span class="nl">"clientOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">自定义id</span><span class="w">
  </span><span class="nl">"createTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390630904"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">创建时间</span><span class="w">
  </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="mi">0</span><span class="err">市价</span><span class="w"> </span><span class="mi">1</span><span class="err">限价</span><span class="w">
  </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易方向</span><span class="w">
  </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托数量</span><span class="w">
  </span><span class="nl">"stf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
  </span><span class="nl">"visibleQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"timeInForce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gtc"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"cancelAfter"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"postOnly"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"positionMerge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"none"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w"> </span><span class="err">none分仓</span><span class="w"> </span><span class="err">long合并多</span><span class="w"> </span><span class="err">short合并空</span><span class="w">
  </span><span class="nl">"positionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提交的仓位id</span><span class="w">
  </span><span class="nl">"close"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">是否为可平单</span><span class="w">
  </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠倍数</span><span class="w">
  </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位行为</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"filled"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单状态</span><span class="w">
  </span><span class="nl">"executedQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交数量</span><span class="w">
  </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
  </span><span class="nl">"executedCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交价值</span><span class="w">
  </span><span class="nl">"fillCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
  </span><span class="nl">"fills"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">成交详情</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"tradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"taker"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数量</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"updateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新时间</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<p><strong>提交委托</strong></p>

<ul>
<li>请求方式 POST</li>
<li>请求路径 /v1/order</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码，如 BTC_USDT, ETH_USDT 等</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>委托类型，有效值 limit market</td>
</tr>
<tr>
<td>client_order_id</td>
<td>string</td>
<td>否</td>
<td>委托id，有效值为int64整数的字符串，建议使用提交委托时的Unix时间戳</td>
</tr>
<tr>
<td>quantity</td>
<td>decimal</td>
<td>是</td>
<td>委托量 有正负</td>
</tr>
<tr>
<td>price</td>
<td>decimal</td>
<td>否</td>
<td>委托限价</td>
</tr>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>必须 spot 现货，lpc U本位永续</td>
</tr>
<tr>
<td>positionMerge</td>
<td>string</td>
<td>否</td>
<td>合约必须 none分仓 long合并多 short合并空</td>
</tr>
<tr>
<td>marginMethod</td>
<td>string</td>
<td>否</td>
<td>合约必须 isolate 逐仓, cross 全仓</td>
</tr>
<tr>
<td>leverage</td>
<td>int</td>
<td>否</td>
<td>合约必须 杠杠倍数</td>
</tr>
<tr>
<td>close</td>
<td>bool</td>
<td>否</td>
<td>合约必须 true 平仓单，false 开仓单</td>
</tr>
<tr>
<td>post_only</td>
<td>bool</td>
<td>否</td>
<td>...</td>
</tr>
<tr>
<td>time_in_force</td>
<td>string</td>
<td>否</td>
<td>委托时效性<br/>有效值 gtc, ioc<br/>gtc 表示未完全成交的委托将一直有效, 直到用户撤销该委托<br/>ioc 表示撮合将立即撤销在下单时刻不能完全成交的委托,<br/> 任何成交都将被保留<br/>默认值 gtc</td>
</tr>
<tr>
<td>positionId</td>
<td>string</td>
<td>否</td>
<td>仓位id</td>
</tr>
</tbody></table>

<blockquote>
<p>委托对象
最多包含该委托的20笔成交
如果委托有多于20笔成交，那么该对象仅包含最后20笔，其他成交请通过 fills 接口获取</p>
</blockquote>
<h2 id='get-an-order'>Get an order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">id=4611772879845982339</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/order?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'id=14118828812271651'</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">query_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span><span class="mi">5000</span><span class="p">))</span> <span class="c1"># optional
</span>    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"orderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4611767382287843330"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
  </span><span class="nl">"clientOrderId"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">自定义id</span><span class="w">
  </span><span class="nl">"createTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390630904"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">创建时间</span><span class="w">
  </span><span class="nl">"product"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="mi">0</span><span class="err">市价</span><span class="w"> </span><span class="mi">1</span><span class="err">限价</span><span class="w">
  </span><span class="nl">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易方向</span><span class="w">
  </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">委托数量</span><span class="w">
  </span><span class="nl">"stf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">委托价格</span><span class="w">
  </span><span class="nl">"visibleQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"timeInForce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gtc"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"cancelAfter"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"postOnly"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"positionMerge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"none"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位模式</span><span class="w"> </span><span class="err">none分仓</span><span class="w"> </span><span class="err">long合并多</span><span class="w"> </span><span class="err">short合并空</span><span class="w">
  </span><span class="nl">"positionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">提交的仓位id</span><span class="w">
  </span><span class="nl">"close"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">是否为可平单</span><span class="w">
  </span><span class="nl">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">杠杠倍数</span><span class="w">
  </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">仓位行为</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"filled"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单状态</span><span class="w">
  </span><span class="nl">"executedQty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交数量</span><span class="w">
  </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
  </span><span class="nl">"executedCost"</span><span class="p">:</span><span class="w"> </span><span class="s2">"103"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">已成交价值</span><span class="w">
  </span><span class="nl">"fillCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交次数</span><span class="w">
  </span><span class="nl">"fills"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">成交详情</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"tradeId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10300"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.01"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"profit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"taker"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"fees"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">资产代码</span><span class="w">
      </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.103"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">数量</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"updateTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1733390650379"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">更新时间</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><strong>获取指定 id 的委托</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/order</li>
<li>权限: View, Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>委托id<br/>委托id可以是交易所分配的, <br/>也可以是用户自定义的 (在提交委托时使用client_order_id参数).<br/>当使用自定义id时, 需要在id前添加 “c:” 前缀.<br/>例如: 提交委托时使用了自定义id “123”, 在获取委托时, 需使用 “c:123”.</td>
</tr>
</tbody></table>
<h2 id='get-orders'>Get Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;status=settled&amp;market=spot&amp;symbol=BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/orders?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span>  <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/orders'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;status=settled&amp;market=spot&amp;symbol=BTC_USDT'</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">query_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span><span class="mi">5000</span><span class="p">))</span> <span class="c1"># optional
</span>    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">orderId</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">4611767382287843330</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 订单id</span>
    <span class="dl">"</span><span class="s2">clientOrderId</span><span class="dl">"</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>  <span class="c1">// 自定义id</span>
    <span class="dl">"</span><span class="s2">createTime</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1733390630904</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 创建时间</span>
    <span class="dl">"</span><span class="s2">product</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">BTC_USDT</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易对代码</span>
    <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1">// 0市价 1限价</span>
    <span class="dl">"</span><span class="s2">side</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">buy</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易方向</span>
    <span class="dl">"</span><span class="s2">quantity</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托数量</span>
    <span class="dl">"</span><span class="s2">stf</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">disabled</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">price</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10300</span><span class="dl">"</span><span class="p">,</span>  <span class="c1">// 委托价格</span>
    <span class="dl">"</span><span class="s2">visibleQty</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">timeInForce</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">gtc</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">cancelAfter</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">postOnly</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">positionMerge</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">none</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 仓位模式 none分仓 long合并多 short合并空</span>
    <span class="dl">"</span><span class="s2">positionId</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1">// 提交的仓位id</span>
    <span class="dl">"</span><span class="s2">close</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>   <span class="c1">// 是否为可平单</span>
    <span class="dl">"</span><span class="s2">leverage</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>    <span class="c1">// 杠杠倍数</span>
    <span class="dl">"</span><span class="s2">action</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">unknown</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 仓位行为</span>
    <span class="dl">"</span><span class="s2">status</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">filled</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 订单状态</span>
    <span class="dl">"</span><span class="s2">executedQty</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 已成交数量</span>
    <span class="dl">"</span><span class="s2">profit</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">,</span>    <span class="c1">// 收益</span>
    <span class="dl">"</span><span class="s2">executedCost</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">103</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 已成交价值</span>
    <span class="dl">"</span><span class="s2">fillCount</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// 成交次数</span>
    <span class="dl">"</span><span class="s2">fills</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>  <span class="c1">// 成交详情</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">tradeId</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">time</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1733390650379</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">price</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10300</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">quantity</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">profit</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">taker</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">fees</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="dl">"</span><span class="s2">asset</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">USDT</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.103</span><span class="dl">"</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="dl">"</span><span class="s2">fees</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>  <span class="c1">// 手续费</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">asset</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">USDT</span><span class="dl">"</span><span class="p">,</span>  <span class="c1">// 资产代码</span>
        <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.103</span><span class="dl">"</span> <span class="c1">// 数量</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="dl">"</span><span class="s2">updateTime</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1733390650379</span><span class="dl">"</span> <span class="c1">// 更新时间</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>
<p><strong>获取ApiKey对应账户中符合下列条件的委托</strong></p>

<ol>
<li>全部未结算委托</li>
<li>三个月内的已结算委托, 含已拒绝, 已撤销和已成交委托</li>
<li>全部已成交委托</li>
<li>全部已撤销的部分成交委托</li>
</ol>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/orders</li>
<li>权限: View, Trade</li>
<li>请求参数(需要排序)</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>string</td>
<td>否</td>
<td>有效值 unsettled, settled<br/>unsettled 表示获取未结算委托，返回结果按委托创建时间倒序排序<br/>settled 表示获取已结算委托，返回结果按委托结算时间倒序排序<br/>默认值 unsettled</td>
</tr>
<tr>
<td>market</td>
<td>string</td>
<td>否</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>交易对代码，如 BTC_USDT, ETH_USDT 等<br/>当 status=unsettled 时, 不指定 symbol 将返回全部交易对的未结算委托<br/>当 status=settled 时, 必须给定 symbol 参数</td>
</tr>
<tr>
<td>start_time</td>
<td>long</td>
<td>否</td>
<td>限定返回委托的最近创建时间</td>
</tr>
<tr>
<td>end_time</td>
<td>long</td>
<td>否</td>
<td>限定返回委托的最近创建时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>委托更新 id<br/>限定返回委托的最大更新id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>委托更新 id<br/>限定返回委托的最小更新id</td>
</tr>
<tr>
<td>limit</td>
<td>long</td>
<td>否</td>
<td>指定最多返回多少个委托</td>
</tr>
</tbody></table>

<ul>
<li><p>该接口支持的参数组合和数据源</p>

<ul>
<li>status=unsettled + symbol</li>
<li>status=settled + symbol + start_time</li>
<li>status=settled + symbol + start_time + limit</li>
<li>status=settled + symbol + end_time</li>
<li>status=settled + symbol + end_time + limit</li>
<li>status=settled + symbol + start_time + end_time</li>
<li>status=settled + symbol + start_time + end_time + limit</li>
<li>status=settled + symbol + before</li>
<li>status=settled + symbol + before + limit</li>
<li>status=settled + symbol + after</li>
<li>status=settled + symbol + after + limit</li>
</ul></li>
</ul>

<blockquote>
<p>返回的unsettled委托按创建时间由早及近排序
返回的settled委托按结算时间由早及近排序</p>
</blockquote>
<h2 id='cancel-an-order'>Cancel an Order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">id</span><span class="p">:</span><span class="dl">'</span><span class="s1">14244173146202090</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/order/delete`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span> <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="s">'14245272657638034'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">body_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/order/delete'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span><span class="mi">5000</span><span class="p">))</span> <span class="c1">#optional
</span>    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="err">n</span><span class="p">]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">取消数量</span><span class="w">
</span></code></pre></div>
<p><strong>撤销指定 id 的委托</strong></p>

<ul>
<li>请求方式 DELETE</li>
<li>请求路径 /v1/order</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>委托id<br>委托id可以是交易所分配的，<br/>也可以是用户自定义的（在提交委托时使用client_order_id参数）。<br>当使用自定义id时，需要在id前添加 “c:” 前缀。<br/>例如：提交委托时使用了自定义id “123”, 在撤销委托时，需使用 “c:123”。</td>
</tr>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
</tbody></table>

<blockquote>
<p>如果指定id的委托已结算，或者不存在指定id的委托，会收到-30001错误。</p>
</blockquote>
<h2 id='cancel-all-orders'>Cancel all Orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>

<span class="kd">const</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">symbol</span><span class="p">:</span><span class="dl">'</span><span class="s1">BTC_USDT</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bodyStr</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">bodyStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/orders`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="k">delete</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span><span class="nx">url</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span><span class="nx">param</span><span class="p">,</span>
        <span class="na">json</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span> <span class="c1">// optional</span>
        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'BTC_USDT'</span>
    <span class="p">}</span>
    <span class="n">body_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">body_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/orders'</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span><span class="mi">5000</span><span class="p">))</span> <span class="c1"># optional
</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="err">n</span><span class="p">]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">取消数量</span><span class="w">
</span></code></pre></div>
<p><strong>撤销全部委托</strong></p>

<ul>
<li>请求方式 DELETE</li>
<li>请求路径 /v1/orders</li>
<li>权限: Trade</li>
<li>请求参数</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>是</td>
<td>交易对代码<br/>如 BTC_USDT, ETH_USDT 等</td>
</tr>
<tr>
<td>side</td>
<td>string</td>
<td>否</td>
<td>buy 或者 sell</td>
</tr>
</tbody></table>

<blockquote>
<p>如果请求被正确执行，返回空数组，否则返回错误信息</p>
</blockquote>
<h2 id='get-fills'>Get fills</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">endpoints</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://api-user.tonetou.com/api</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e03e8fda27b6e4fc6b29bb244747dcf64092996</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">b825a03636ca09c884ca11d71cfc4217a98cb8bf</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>


<span class="kd">const</span> <span class="nx">queryStr</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">limit=2&amp;market=spot&amp;symbol=BTC_USDT</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">queryStr</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoints</span><span class="p">}</span><span class="s2">/v1/fills?</span><span class="p">${</span><span class="nx">queryStr</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-expire-time</span><span class="dl">'</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="mi">5000</span> <span class="c1">// optional</span>

        <span class="p">},</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.the result</span>

    <span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">END_POINT</span> <span class="o">=</span> <span class="s">'https://api-user.tonetou.com/api'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e03e8fda27b6e4fc6b29bb244747dcf64092996'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'b825a03636ca09c884ca11d71cfc4217a98cb8bf'</span>


<span class="k">def</span> <span class="nf">do_request</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/v1/fills'</span>
    <span class="n">query_str</span> <span class="o">=</span> <span class="s">'limit=2&amp;market=spot&amp;symbol=BTC_USDT'</span>
    <span class="c1"># POST or DELETE replace query_str with body_str
</span>    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">query_str</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-expire-time'</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span><span class="mi">5000</span><span class="p">))</span> <span class="c1"># optional
</span>    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">END_POINT</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">query_str</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">do_request</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"product"</span><span class="p">:</span><span class="s2">"BTC_USDT_SWAP"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">交易对代码</span><span class="w">
    </span><span class="nl">"fees"</span><span class="p">:[{</span><span class="nl">"amount"</span><span class="p">:</span><span class="s2">"10"</span><span class="p">,</span><span class="nl">"asset"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">}],</span><span class="err">//</span><span class="w"> </span><span class="err">手续费</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="s2">"0.01"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交数量</span><span class="w">
    </span><span class="nl">"orderId"</span><span class="p">:</span><span class="s2">"4611772879845982371"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">订单id</span><span class="w">
    </span><span class="nl">"price"</span><span class="p">:</span><span class="s2">"1000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交价格</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="s2">"1733541360859"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">成交时间</span><span class="w">
    </span><span class="nl">"taker"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">是否为吃单</span><span class="w">
    </span><span class="nl">"profit"</span><span class="p">:</span><span class="s2">"-9060"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">收益</span><span class="w">
    </span><span class="nl">"tradeId"</span><span class="p">:</span><span class="mi">26</span><span class="w"> 
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p><strong>获取成交记录</strong></p>

<ul>
<li>请求方式 GET</li>
<li>请求路径 /v1/fills</li>
<li>权限: View, Trade</li>
<li>请求参数(需要排序)</li>
</ul>

<table><thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>是否必传</th>
<th>说明</th>
</tr>
</thead><tbody>
<tr>
<td>market</td>
<td>string</td>
<td>是</td>
<td>交易对市场，如 spot, lpc 等，spot为现货,lpc为U本位合约</td>
</tr>
<tr>
<td>order_id</td>
<td>string</td>
<td>否</td>
<td>交易所分配的委托id<br/>限定仅返回指定委托的成交记录<br/>如果不指定该参数，请指定 symbol</td>
</tr>
<tr>
<td>symbol</td>
<td>string</td>
<td>否</td>
<td>交易对代码<br/>如 BTC_USDT, ETH_USDT 等<br/>限定仅返回指定交易对的成交记录<br/>如果不指定该参数，请指定 order_id</td>
</tr>
<tr>
<td>start_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回成交记录的最早时间</td>
</tr>
<tr>
<td>end_time</td>
<td>int64</td>
<td>否</td>
<td>限定返回成交记录的最近时间</td>
</tr>
<tr>
<td>before</td>
<td>int64</td>
<td>否</td>
<td>成交记录 id<br/>限定返回成交记录的最大id</td>
</tr>
<tr>
<td>after</td>
<td>int64</td>
<td>否</td>
<td>成交记录 id<br/>限定返回成交记录的最小id</td>
</tr>
<tr>
<td>limit</td>
<td>int32</td>
<td>否</td>
<td>限定返回结果的最大条数<br/>默认值 100</td>
</tr>
</tbody></table>

<ul>
<li><p>该接口支持的参数组合和数据源</p>

<ul>
<li>symbol  --&gt; database</li>
<li>symbol + limit  --&gt; database</li>
<li>symbol + start_time  --&gt; database</li>
<li>symbol + start_time + limit  --&gt; database</li>
<li>symbol + end_time  --&gt; database</li>
<li>symbol + end_time + limit  --&gt; database</li>
<li>symbol + start_time + end_time  --&gt; database</li>
<li>symbol + start_time + end_time + limit  --&gt; database</li>
<li>symbol + before  --&gt; database</li>
<li>symbol + before + limit  --&gt; database</li>
<li>symbol + after  --&gt; database</li>
<li>symbol + after + limit  --&gt; database</li>
<li>order_id  --&gt; database</li>
<li>order_id + limit  --&gt; database</li>
<li>order_id + before  --&gt; database</li>
<li>order_id + before + limit  --&gt; database</li>
</ul></li>
</ul>

<blockquote>
<p>返回结果按成交记录id由小到大排序</p>
</blockquote>
<h1 id='user-data-streams'>User Data Streams</h1><h2 id='overview-2'>Overview</h2>
<blockquote>
<p>例子</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">madexws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://madex-user.tonetou.com</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">9e2bd17ff73e8531c0f3c26f93e48bfa402a3b13</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">const</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">ca55beb9e45d4f30b3959b464402319b9e12bac7</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// your secret</span>
<span class="kd">const</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="dl">"</span><span class="s2">/user/verify</span><span class="dl">"</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>


<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">madexws</span><span class="p">);</span>

  <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">madexws</span><span class="p">);</span>
  <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
      <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">LOGIN</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">auth</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span> <span class="dl">"</span><span class="s2">api-sign</span><span class="dl">"</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}));</span>
    <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">ws</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
    <span class="p">},</span><span class="mi">30000</span><span class="p">)</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span>  <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error </span><span class="dl">'</span><span class="p">,</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
  <span class="p">});</span>

  <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span> <span class="c1">// the data may be is error message,check the data's stream is order or account</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">websocket</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://user-wss.madex360.com'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'9e2bd17ff73e8531c0f3c26f93e48bfa402a3b13'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'ca55beb9e45d4f30b3959b464402319b9e12bac7'</span>
<span class="n">SIGN</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="s">"/user/verify"</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">({</span>
        <span class="s">"method"</span><span class="p">:</span> <span class="s">"LOGIN"</span><span class="p">,</span>
        <span class="s">"auth"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"api-key"</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
            <span class="s">"api-sign"</span><span class="p">:</span> <span class="n">SIGN</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### opened ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="c1"># websocket.enableTrace(True)
</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div>
<p>使用 Websocket 推送服务可以及时获取账户的余额及委托变动信息。</p>

<p><strong>连接 Websocket 服务器</strong></p>

<p>请使用以下 URL 连接 Websocket 服务器：</p>

<p>wss://user-wss.madex360.com</p>

<p><strong>在连接时，请附加以下HTTP请求头</strong></p>

<ul>
<li>BIBOX-API-KEY</li>
<li>BIBOX-API-SIGN</li>
<li>BIBOX-TIMESTAMP</li>
</ul>

<p><em>具体方法请参考<a href="#authentication">Authentication</a>章节</em></p>

<blockquote>
<p>数据流
在成功建立连接后，客户端将收到ApiKey对应账户的余额变动信息及委托变动信息。格式如下:</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">account</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="nx">Account</span> <span class="p">}</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">order</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="nx">Order</span> <span class="p">}</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">order</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="nx">Position</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id='account'>Account</h2>
<p><strong>当账户余额发生变更时，会收到account事件</strong></p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">account</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">asset</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">USDT</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 资产代码</span>
      <span class="dl">"</span><span class="s2">balance</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">100000</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 余额</span>
      <span class="dl">"</span><span class="s2">holds</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">20016.9970000</span><span class="dl">"</span> <span class="c1">// 冻结</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id='position'>Position</h2>
<p><strong>当仓位信息发送变更时，会收到position事件</strong>
<code>javascript
{
  &quot;stream&quot;: &quot;position&quot;,
  &quot;data&quot;: {
      &quot;id&quot;:&quot;1125899906842624003&quot;, // 仓位id
      &quot;symbol&quot;:&quot;BTC_USDT_SWAP&quot;, // 交易对代码
      &quot;quantity&quot;:&quot;0&quot;,   // 数量
      &quot;entryPrice&quot;:&quot;0&quot;, // 开仓均价
      &quot;mergeMode&quot;:&quot;none&quot;, // 仓位模式
      &quot;marginMethod&quot;:&quot;isolate&quot;,//仓位模式
      &quot;leverage&quot;:&quot;10.0&quot;, // 杠杠
      &quot;initMargin&quot;:&quot;0.1&quot;, // 起始保证金率
      &quot;maintMargin&quot;:&quot;0.005&quot;,// 维持保证金率
      &quot;posMargin&quot;:&quot;0&quot;, // 持仓保证金
      &quot;orderMargin&quot;:&quot;1009.8990000&quot; // 委托保证金
  }
}
</code></p>
<h2 id='order'>Order</h2>
<p><strong>当委托发生变更时，会收到order事件</strong></p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">stream</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">order</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">:{</span>
    <span class="dl">"</span><span class="s2">orderId</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">4611767382287843330</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 订单id</span>
      <span class="dl">"</span><span class="s2">clientOrderId</span><span class="dl">"</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>  <span class="c1">// 自定义id</span>
      <span class="dl">"</span><span class="s2">createTime</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1733390630904</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 创建时间</span>
      <span class="dl">"</span><span class="s2">product</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">BTC_USDT</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易对代码</span>
      <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1">// 0市价 1限价</span>
      <span class="dl">"</span><span class="s2">side</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">buy</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 交易方向</span>
      <span class="dl">"</span><span class="s2">quantity</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 委托数量</span>
      <span class="dl">"</span><span class="s2">stf</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">disabled</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">price</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10300</span><span class="dl">"</span><span class="p">,</span>  <span class="c1">// 委托价格</span>
      <span class="dl">"</span><span class="s2">visibleQty</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">timeInForce</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">gtc</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">cancelAfter</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">postOnly</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">positionMerge</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">none</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 仓位模式 none分仓 long合并多 short合并空</span>
      <span class="dl">"</span><span class="s2">positionId</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1">// 提交的仓位id</span>
      <span class="dl">"</span><span class="s2">close</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>   <span class="c1">// 是否为可平单</span>
      <span class="dl">"</span><span class="s2">leverage</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>    <span class="c1">// 杠杠倍数</span>
      <span class="dl">"</span><span class="s2">action</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">unknown</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 仓位行为</span>
      <span class="dl">"</span><span class="s2">status</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">filled</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 订单状态</span>
      <span class="dl">"</span><span class="s2">executedQty</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 已成交数量</span>
      <span class="dl">"</span><span class="s2">profit</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">,</span>    <span class="c1">// 收益</span>
      <span class="dl">"</span><span class="s2">executedCost</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">103</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// 已成交价值</span>
      <span class="dl">"</span><span class="s2">fillCount</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// 成交次数</span>
      <span class="dl">"</span><span class="s2">fills</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>  <span class="c1">// 成交详情</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">tradeId</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">time</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1733390650379</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">price</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">10300</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">quantity</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">profit</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">taker</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">fees</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="dl">"</span><span class="s2">asset</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">USDT</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.103</span><span class="dl">"</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">],</span>
      <span class="dl">"</span><span class="s2">fees</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>  <span class="c1">// 手续费</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">asset</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">USDT</span><span class="dl">"</span><span class="p">,</span>  <span class="c1">// 资产代码</span>
        <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0.103</span><span class="dl">"</span> <span class="c1">// 数量</span>
      <span class="p">}</span>
    <span class="p">],</span>
      <span class="dl">"</span><span class="s2">updateTime</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1733390650379</span><span class="dl">"</span> <span class="c1">// 更新时间</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h1 id='errors'>Errors</h1><h2 id='e08c1d4f9a'>错误码</h2>
<ul>
<li>-1xxx 网络或服务器故障</li>
<li>-2xxx 请求, 头或参数错误</li>
<li>-3xxx 请求无法被正确处理</li>
</ul>

<table><thead>
<tr>
<th style="text-align: center">Code</th>
<th style="text-align: center">描述</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">-1000</td>
<td style="text-align: center">Unknown</td>
</tr>
<tr>
<td style="text-align: center">-2001</td>
<td style="text-align: center">未给定请求头</td>
</tr>
<tr>
<td style="text-align: center">-2002</td>
<td style="text-align: center">请求头的值无效</td>
</tr>
<tr>
<td style="text-align: center">-2003</td>
<td style="text-align: center">未给定参数</td>
</tr>
<tr>
<td style="text-align: center">-2004</td>
<td style="text-align: center">参数的值无效</td>
</tr>
<tr>
<td style="text-align: center">-2005</td>
<td style="text-align: center">Body 含有无效的 Json 格式</td>
</tr>
<tr>
<td style="text-align: center">-2006</td>
<td style="text-align: center">无效的签名</td>
</tr>
<tr>
<td style="text-align: center">-2101</td>
<td style="text-align: center">已超出规定的 API 访问次数限制</td>
</tr>
<tr>
<td style="text-align: center">-2102</td>
<td style="text-align: center">已超出规定的 API 用量限制</td>
</tr>
<tr>
<td style="text-align: center">-2103</td>
<td style="text-align: center">ApiKey 未被授予相关权限</td>
</tr>
<tr>
<td style="text-align: center">-2104</td>
<td style="text-align: center">请求过期</td>
</tr>
<tr>
<td style="text-align: center">-3001</td>
<td style="text-align: center">指定的资产不存在</td>
</tr>
<tr>
<td style="text-align: center">-3002</td>
<td style="text-align: center">指定的交易对不存在</td>
</tr>
<tr>
<td style="text-align: center">-3003</td>
<td style="text-align: center">指定的委托不存在</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="csharp">csharp</a>
          </div>
      </div>
    </div>
  </body>
      <script>
        const lang_btn = document.getElementById('lang_box');
        const btn_spot_v4 = document.getElementById('btn_spot_v4');
        const btn_spot = document.getElementById('btn_spot');
        const btn_contract = document.getElementById('btn_contract-select');
        const btn_contract_v3 = document.getElementById('btn_contract_v3')
        const btn_contract_v4 = document.getElementById('btn_contract_v4')
        const btn_contract_coin = document.getElementById('btn_contract_coin')

        const btnSpotSelect = document.getElementById('btn_spot-select')
        const spot_select = document.getElementById('spot_select')

        const biboxLogo = document.getElementById('bibox-logo')

        const url = GetUrlRelativePath();

        if(url.indexOf('en') != -1){
          //英文
          btnSpotSelect.innerHTML = 'Spot'
          lang_btn.innerHTML = '中文';
          btn_spot.innerHTML = 'Spot v3';
          btn_spot_v4.innerHTML = 'Spot v4'
          btn_contract_coin.innerHTML = 'Contract Coin';
          btn_contract.innerHTML = 'Contract USDT';
          btn_contract_v3.innerHTML = 'Contract USDT v3';
          btn_contract_v4.innerHTML = 'Contract USDT v4';

          lang_btn.href = url.replace('en/', 'zh/');
          btn_spot.href = btn_spot.href.replace('zh/', 'en/');
          btn_spot_v4.href = btn_spot_v4.href.replace('zh/', 'en/')
          btn_contract_coin.href = btn_contract_coin.href.replace('zh/', 'en/');
          btn_contract_v3.href = btn_contract_v3.href.replace('zh/', 'en/');
          btn_contract_v4.href = btn_contract_v4.href.replace('zh/', 'en/');

          biboxLogo.onclick = function () {
            window.location.href = 'https://www.bibox.tech/en'
          }
        }else{
          //中文
          btnSpotSelect.innerHTML = '现货'
          lang_btn.innerHTML = 'English';
          btn_spot.innerHTML = '现货 v3';
          btn_spot_v4.innerHTML = '现货 v4'
          btn_contract_coin.innerHTML = '币本位永续合约';
          btn_contract.innerHTML = 'U本位永续合约';
          btn_contract_v3.innerHTML = 'U本位永续合约 v3';
          btn_contract_v4.innerHTML = 'U本位永续合约 v4';

          lang_btn.href = url.replace('zh/', 'en/');
          btn_spot.href = btn_spot.href.replace('en/', 'zh/');
          btn_spot_v4.href = btn_spot_v4.href.replace('en/', 'zh/');
          btn_contract_coin.href = btn_contract_coin.href.replace('en/', 'zh/');
          btn_contract_v3.href = btn_contract_v3.href.replace('en/', 'zh/');
          btn_contract_v4.href = btn_contract_v4.href.replace('en/', 'zh/');
          biboxLogo.onclick = function () {
            window.location.href = 'https://www.bibox.tech/zh'
          }
        }

        if(location.href.indexOf('/spot/v4/') > 0){
          btn_spot_v4.className = 'current';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_spot.className = '';
          spot_select.className = spot_select.className + ' current';
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML + ' v4'
        } else if(location.href.indexOf('/spot/v3/') > 0){
          btn_spot.className = 'current';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_spot_v4.className = '';
          spot_select.className = spot_select.className + ' current';
          btnSpotSelect.innerHTML = btnSpotSelect.innerHTML + ' v3'
        }
        else if(location.href.indexOf('/futures-coin/') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = 'current';
          btn_contract.className = '';
          btn_spot_v4.className = '';
        }
        else if(location.href.indexOf('/futures/v4') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = '';
          btn_contract.className = '';
          btn_contract.innerHTML = btn_contract.innerHTML + ' v4';
          btn_contract_v3.className = '';
          btn_contract_v4.className = 'current';
          btn_spot_v4.className = '';
          console.log('futures-v4', btn_contract)
        }
        else if(location.href.indexOf('/futures/') > 0){
          btn_spot.className = '';
          btn_contract_coin.className = '';
          btn_contract.innerHTML = btn_contract.innerHTML + ' v3';
          btn_contract.className = '';
          btn_contract_v4.className = '';
          btn_contract_v3.className = 'current';
          btn_spot_v4.className = '';
          console.log('futures-v3', btn_contract)
        }

        lang_btn.style.display = 'block';
        function GetUrlRelativePath(){
          let url = document.location.toString();
          let arrUrl = url.split("//");
          let start = arrUrl[1].indexOf("/");
          let relUrl = arrUrl[1].substring(start);
          if(relUrl.indexOf("?") != -1){
            relUrl = relUrl.split("?")[0];
          }
          if(relUrl.indexOf("#") != -1){
            relUrl = relUrl.split("#")[0];
          }
          return relUrl;
    　　}
      </script>
</html>
